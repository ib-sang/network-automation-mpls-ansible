!
ip vrf A
 rd 10.255.255.20:1
 route-target export 10.255.255.20:1
 route-target import 10.255.255.20:1
!
ip vrf B
 rd 10.255.255.30:1
 route-target export 10.255.255.30:1
 route-target import 10.255.255.30:1
!
!
interface GigabitEthernet0/0
 ip vrf forwarding A
 ip address 10.255.10.1 255.255.255.252
 media-type gbic
 speed 1000
 duplex full
 negotiation auto
!
interface GigabitEthernet1/0
 ip vrf forwarding B
 ip address 10.255.20.1 255.255.255.252
 negotiation auto
!
interface GigabitEthernet2/0
 no ip address
 negotiation auto
 no keepalive
 xconnect 10.255.255.12 100 encapsulation mpls
!
router eigrp 200
 !
 address-family ipv4 vrf B
  redistribute bgp 64512
  network 10.255.20.0 0.0.0.3
  autonomous-system 200
 exit-address-family
 network 172.20.0.0
!
router ospf 2 vrf A
 redistribute bgp 64512 subnets
 network 10.255.10.0 0.0.0.3 area 10
!
router bgp 64512
 bgp log-neighbor-changes
 neighbor 10.255.255.12 remote-as 64512
 neighbor 10.255.255.12 update-source Loopback0
 !
 address-family ipv4
  neighbor 10.255.255.12 activate
 exit-address-family
 !
 address-family vpnv4
  neighbor 10.255.255.12 activate
  neighbor 10.255.255.12 send-community extended
 exit-address-family
 !
 address-family ipv4 vrf A
  redistribute ospf 2 metric 1
 exit-address-family
 !
 address-family ipv4 vrf B
  redistribute eigrp 200
 exit-address-family
!
